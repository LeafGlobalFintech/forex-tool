on: ['push', 'pull_request']

name: Test Coveralls

jobs:
    build:
        name: Build
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v1

            - name: Use Node.js 16.x
              uses: actions/setup-node@v1
              with:
                  node-version: 16.x

            - name: Install depenedencies and test
              run: |
                  npm ci
                  npm run test-cov
              env:
                  ENVIRONMENT: ${{secrets.ENVIRONMENT}}
                  DEVELOPER: ${{secrets.DEVELOPER}}
                  PORT: ${{secrets.PORT}}

            - name: Coveralls
              uses: coverallsapp/github-action@master
              with:
                  repo_token: ${{ secrets.REPO_TOKEN }}
